<html itemtype="http://schema.org/WebPage" lang="en">
    <head>
    <meta charset="utf-8"/>
    <title>
        URL Shortner | shreyasgaonkar.com
    </title>
    </head>
    <body>
      <LINK href="https://stackpath.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" type="text/css">
      <style>
        html{
          border: 0; 
          margin:0; 
          padding: 20px;
        }
        h1,h2, #link, a {
          color: #c2dea0 !important;
        }
        body {
          background-color: #3a1e5c;
        }
        #urltext {
          max-width: 100%;
        }
      </style>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" type="text/javascript"></script>
    <script type="text/javascript">
    
    $(document).ready(function() {
        
   
      
        $('#submit').click(function(e) {
            e.preventDefault();
     
            var urlData = $('#urltext').val();
            //var apiKey = $('#apikey').val();
            var headersData = {'url': urlData};
            //var headersData = {'X-Api-Key': apiKey, 'url': urlData};
     
            $.ajax({
                type: "POST",
                url: window.location.pathname,
                headers: headersData,
                contentType: "application/json", 
                dataType: 'json',
                success: function(response) {
                    console.log(response);
                  var hlink = '<a href="' + response + '" target="_blank">' + response + '</a>';
                  console.log(hlink);
                  $('#link').html(hlink);
                  $('.alert-success').css("display", "block");
                  //alert('Your tiny URL has been generated and is shown under "Output"');
                },
                error: function(xhr, ajaxOptions, thrownError) {
                  $('.alert-danger').css("display", "block");
                    var rbody = xhr.responseJSON;
                    console.log(ajaxOptions);
                    console.log(xhr.status);
                    console.log("thrown error is " + thrownError);
                    if(xhr.status==403) {
                        alert('You shall not pass!');
                    } else if(xhr.status==400) {
                        alert('Something\'s amiss... Try again.');
                    } else if(xhr.status==429 && rbody.message=="Limit Exceeded") {
                        alert('You have exceeded the number of requests today.  Try again tomorrow.')
                    } else if(xhr.status==429) {
                        alert('You need to slowwwwww dowwwwwwwwn.')
                    } 
                  // else {
                  //       alert('What did you break?');
                  //   }
                }
            });
        });
    });
    </script>
    
      <div class="container">
    
     
       <div class="alert alert-success alert-dismissible fade show"  role="alert" style="display: none;">
  <strong>Sweet!</strong> See the shortned url below.
  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
       
              <div class="alert alert-danger alert-dismissible fade show" role="alert" style="display: none;">
  <strong>Umm..?!</strong> Something went wrong. <a href="." class="alert-link">Refresh?</a>.
  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
    
  
    <h1>Tiny URL</h1>
    <textarea id="urltext" rows="2" cols="75" maxlength="400000" autocomplete="off" required autofocus></textarea>
    <br/><br/>
    <button id="submit">Shrink It!</button>
    <br /><br />
    <div class="row">
    <h2>Output: &nbsp;</h2>
    <div id="link" class="align-self-center">Your tiny URL will appear here after you Shrink It!</div>
    </div>     
    </div> <!-- end container -->
   
     <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" type="text/javascript"></script>
    </body>
    </html>
